<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>pathfindR Analysis for non-Homo-sapiens organisms • pathfindR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="pathfindR Analysis for non-Homo-sapiens organisms">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pathfindR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.4.3.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/intro_vignette.html">Introduction to pathfindR</a>
    </li>
    <li>
      <a href="../articles/manual_execution.html">Step-by-Step Execution of the pathfindR Enrichment Workflow</a>
    </li>
    <li>
      <a href="../articles/non_hs_analysis.html">pathfindR Analysis for non-Homo-sapiens organisms</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/egeulgen/pathfindR">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>pathfindR Analysis for non-Homo-sapiens organisms</h1>
                        <h4 class="author">Ege Ulgen</h4>
            
            <h4 class="date">2020-01-12</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/egeulgen/pathfindR/blob/master/vignettes/non_hs_analysis.Rmd"><code>vignettes/non_hs_analysis.Rmd</code></a></small>
      <div class="hidden name"><code>non_hs_analysis.Rmd</code></div>

    </div>

    
    
<p>As mentioned in the vignette <a href="intro_vignette.html">Introduction to pathfindR</a>, enrichment analysis with pathfindR is not limited to the built-in data. The users are able to utilize custom protein-protein interaction networks (PINs) as well as custom gene sets. These abilities to use custom data naturally allow for performing pathfindR analysis on non-Homo-sapiens input data. In this vignette, we’ll try to provide an overview of how pathfindR analysis using Mus musculus data can be performed.</p>
<div id="preparation-of-necessary-data" class="section level1">
<h1 class="hasAnchor">
<a href="#preparation-of-necessary-data" class="anchor"></a>Preparation of Necessary Data</h1>
<p>For performing non-human active-subnetwork-oriented enrichment analysis, the user needs the following resources:</p>
<ul>
<li>organism-specific protein interaction network (PIN) data</li>
<li>organism-specific gene sets data</li>
</ul>
<p>After obtaining and processing these data for use, the user can run pathfindR using custom parameters.</p>
<blockquote>
<p>Important Note: Because the non-human organism-specific PIN will likely contain less interactions than the Homo sapiens PIN, pathfindR may result in less (or even no) enriched terms!</p>
</blockquote>
<div id="obtain-organism-specific-gene-sets" class="section level2">
<h2 class="hasAnchor">
<a href="#obtain-organism-specific-gene-sets" class="anchor"></a>Obtain Organism-specific Gene Sets</h2>
<p>We first obtain the most up-to-date M.musculus (KEGG identifier: mmu) KEGG Gene Sets using the R package <code>KEGGREST</code>.</p>
<blockquote>
<p>If using another organism, all you have to do is to replace “mmu” with the KEGG organism code in the related arguments in this vignette.</p>
</blockquote>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(KEGGREST)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">#### Obtain list of M.musculus pathways</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">mmu_kegg_descriptions &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/KEGGREST/man/keggList.html">keggList</a></span>(<span class="st">"pathway"</span>, <span class="st">"mmu"</span>)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co"># Shorten descriptions</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6">mmu_kegg_descriptions &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/grep.html">sub</a></span>(<span class="st">" - Mus musculus </span><span class="ch">\\</span><span class="st">(mouse</span><span class="ch">\\</span><span class="st">)"</span>, <span class="st">""</span>, mmu_kegg_descriptions)</a>
<a class="sourceLine" id="cb1-7" data-line-number="7"></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co"># Turn the identifiers into KEGG-style pathway identifiers (org_id#####)</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(mmu_kegg_descriptions) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/grep.html">sub</a></span>(<span class="st">"path:"</span>, <span class="st">""</span>, <span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(mmu_kegg_descriptions))</a>
<a class="sourceLine" id="cb1-10" data-line-number="10"></a>
<a class="sourceLine" id="cb1-11" data-line-number="11">#### Obtain and parse genes per each pathway</a>
<a class="sourceLine" id="cb1-12" data-line-number="12">mmu_kegg_genes &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(mmu_kegg_descriptions), <span class="cf">function</span>(pwid){</a>
<a class="sourceLine" id="cb1-13" data-line-number="13">  pw &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/KEGGREST/man/keggGet.html">keggGet</a></span>(pwid)</a>
<a class="sourceLine" id="cb1-14" data-line-number="14">  pw &lt;-<span class="st"> </span>pw[[<span class="dv">1</span>]]<span class="op">$</span>GENE[<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="ot">FALSE</span>, <span class="ot">TRUE</span>)] <span class="co"># get gene symbols, not descriptions</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15">  pw &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/grep.html">sub</a></span>(<span class="st">";.+"</span>, <span class="st">""</span>, pw) <span class="co"># discard any remaining description</span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16">  pw &lt;-<span class="st"> </span>pw[<span class="kw"><a href="https://rdrr.io/r/base/grep.html">grep</a></span>(<span class="st">"^[A-Za-z0-9_-]+(</span><span class="ch">\\</span><span class="st">@)?$"</span>, pw)] <span class="co"># remove any mistaken lines that cannot be gene symbols</span></a>
<a class="sourceLine" id="cb1-17" data-line-number="17">  pw &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(pw) <span class="co"># keep unique symbols</span></a>
<a class="sourceLine" id="cb1-18" data-line-number="18">  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(pw)</a>
<a class="sourceLine" id="cb1-19" data-line-number="19">})</a>
<a class="sourceLine" id="cb1-20" data-line-number="20"></a>
<a class="sourceLine" id="cb1-21" data-line-number="21">#### Filter terms to exclude those with 0 genes (metabolic pathways)</a>
<a class="sourceLine" id="cb1-22" data-line-number="22">mmu_kegg_genes &lt;-<span class="st"> </span>mmu_kegg_genes[<span class="kw"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(mmu_kegg_genes, length) <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>]</a>
<a class="sourceLine" id="cb1-23" data-line-number="23">mmu_kegg_descriptions &lt;-<span class="st"> </span>mmu_kegg_descriptions[<span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(mmu_kegg_descriptions) <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(mmu_kegg_genes)]</a></code></pre></div>
<p>The M.musculus KEGG pathway gene set data <code>mmu_kegg_genes</code> and <code>mmu_kegg_descriptions</code> are already provided in pathfindR. For other organisms, the user may wish to save the gene set objects as RDS files for future use:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">## Save both as RDS files for later use</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span>(mmu_kegg_genes, <span class="st">"mmu_kegg_genes.RDS"</span>)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span>(mmu_kegg_descriptions, <span class="st">"mmu_kegg_descriptions.RDS"</span>)</a></code></pre></div>
<p>These can be later loaded via:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">mmu_kegg_genes &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span>(<span class="st">"mmu_kegg_genes.RDS"</span>)</a></code></pre></div>
</div>
<div id="obtain-organism-specific-protein-protein-interaction-network" class="section level2">
<h2 class="hasAnchor">
<a href="#obtain-organism-specific-protein-protein-interaction-network" class="anchor"></a>Obtain Organism-specific Protein-protein Interaction Network</h2>
<p>We recommend obtaining the organism-specific protein-protein interaction network (PIN) from <a href="https://stringdb-static.org/cgi/download.pl">STRING</a>. You may choose the organism of your choice and find the PIN on the downloads page with the description “protein network data (scored links between proteins)”. When processing, we recommend filtering the interactions using a link score threshold (e.g. 800).</p>
<p>Alternatively, you obtain the organism-specific PIN from <a href="https://downloads.thebiogrid.org/BioGRID">BioGRID</a>. Under “Current-Release”, download <code>BIOGRID-ORGANISM-X.X.X.tab2.zip</code>. This contains PIN data for a large number of organisms. The data the user needs is named as <code>BIOGRID-ORGANISM-YOUR_ORGANISM-X.X.X.tab.txt</code> (e.g. BIOGRID-ORGANISM-Mus_musculus-3.5.169.tab.txt).</p>
<blockquote>
<p>Note that BioGRID PINs are smaller for non-H.sapiens organisms and that this in turn results in less or no significantly enriched terms with pathfindR analysis.</p>
</blockquote>
<p>Regardless of the resource, the raw PIN data should be processed to a SIF file, each interactor should be specified with their gene symbols. The first 3 interactions from an example SIF file is provided below:</p>
<table class="table"><tbody>
<tr class="odd">
<td align="left">C2cd2</td>
<td align="left">pp</td>
<td align="left">Ints2</td>
</tr>
<tr class="even">
<td align="left">Apob</td>
<td align="left">pp</td>
<td align="left">Gpt</td>
</tr>
<tr class="odd">
<td align="left">B4galnt1</td>
<td align="left">pp</td>
<td align="left">Mettl1</td>
</tr>
</tbody></table>
<p>Notice there are no headers and each line contains an interaction in the form <code>GeneA pp GeneB</code>, separated by tab (i.e. <code>\t</code>) with no row names and no column names.</p>
<p>Below we download process the STRING PIN for use with pathfindR:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">## Downloading the STRING PIN file to tempdir</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">url &lt;-<span class="st"> "https://stringdb-static.org/download/protein.links.v11.0/10090.protein.links.v11.0.txt.gz"</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3">path2file &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span>(<span class="dt">check =</span> <span class="ot">TRUE</span>), <span class="st">"STRING.txt.gz"</span>)</a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/utils/download.file.html">download.file</a></span>(url, path2file)</a>
<a class="sourceLine" id="cb4-5" data-line-number="5"></a>
<a class="sourceLine" id="cb4-6" data-line-number="6">## read STRING pin file</a>
<a class="sourceLine" id="cb4-7" data-line-number="7">mmu_string_df &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span>(path2file, <span class="dt">header =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb4-8" data-line-number="8"></a>
<a class="sourceLine" id="cb4-9" data-line-number="9">## filter using combined_score cut-off value of 800</a>
<a class="sourceLine" id="cb4-10" data-line-number="10">mmu_string_df &lt;-<span class="st"> </span>mmu_string_df[mmu_string_df<span class="op">$</span>combined_score <span class="op">&gt;=</span><span class="st"> </span><span class="dv">800</span>, ]</a>
<a class="sourceLine" id="cb4-11" data-line-number="11"></a>
<a class="sourceLine" id="cb4-12" data-line-number="12">## fix ids</a>
<a class="sourceLine" id="cb4-13" data-line-number="13">mmu_string_pin &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">Interactor_A =</span> <span class="kw"><a href="https://rdrr.io/r/base/grep.html">sub</a></span>(<span class="st">"^10090</span><span class="ch">\\</span><span class="st">."</span>, <span class="st">""</span>, mmu_string_df<span class="op">$</span>protein1),</a>
<a class="sourceLine" id="cb4-14" data-line-number="14">                             <span class="dt">Interactor_B =</span> <span class="kw"><a href="https://rdrr.io/r/base/grep.html">sub</a></span>(<span class="st">"^10090</span><span class="ch">\\</span><span class="st">."</span>, <span class="st">""</span>, mmu_string_df<span class="op">$</span>protein2))</a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(mmu_string_pin, <span class="dv">2</span>)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Interactor_A</th>
<th align="left">Interactor_B</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">ENSMUSP00000000001</td>
<td align="left">ENSMUSP00000017460</td>
</tr>
<tr class="even">
<td align="left">ENSMUSP00000000001</td>
<td align="left">ENSMUSP00000039107</td>
</tr>
</tbody>
</table>
<p>Since the interactors are Ensembl peptide IDs, we’ll need to convert them to MGI symbols for use with pathfindR. This can be achieved via <code>biomaRt</code> or any other conversion method you prefer:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(biomaRt)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">mmu_ensembl &lt;-<span class="st"> </span><span class="kw">useMart</span>(<span class="st">"ensembl"</span>, <span class="dt">dataset =</span> <span class="st">"mmusculus_gene_ensembl"</span>)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">converted &lt;-<span class="st"> </span><span class="kw">getBM</span>(<span class="dt">attributes =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"ensembl_peptide_id"</span>, <span class="st">"mgi_symbol"</span>),</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">                   <span class="dt">filters =</span> <span class="st">"ensembl_peptide_id"</span>,</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">                   <span class="dt">values =</span> <span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(mmu_string_pin)),</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">                   <span class="dt">mart =</span> mmu_ensembl)</a>
<a class="sourceLine" id="cb5-7" data-line-number="7">mmu_string_pin<span class="op">$</span>Interactor_A &lt;-<span class="st"> </span>converted<span class="op">$</span>mgi_symbol[<span class="kw"><a href="https://rdrr.io/r/base/match.html">match</a></span>(mmu_string_pin<span class="op">$</span>Interactor_A, converted<span class="op">$</span>ensembl_peptide_id)]</a>
<a class="sourceLine" id="cb5-8" data-line-number="8">mmu_string_pin<span class="op">$</span>Interactor_B &lt;-<span class="st"> </span>converted<span class="op">$</span>mgi_symbol[<span class="kw"><a href="https://rdrr.io/r/base/match.html">match</a></span>(mmu_string_pin<span class="op">$</span>Interactor_B, converted<span class="op">$</span>ensembl_peptide_id)]</a>
<a class="sourceLine" id="cb5-9" data-line-number="9">mmu_string_pin &lt;-<span class="st"> </span>mmu_string_pin[<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(mmu_string_pin<span class="op">$</span>Interactor_A) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(mmu_string_pin<span class="op">$</span>Interactor_B), ]</a>
<a class="sourceLine" id="cb5-10" data-line-number="10">mmu_string_pin &lt;-<span class="st"> </span>mmu_string_pin[mmu_string_pin<span class="op">$</span>Interactor_A <span class="op">!=</span><span class="st"> ""</span> <span class="op">&amp;</span><span class="st"> </span>mmu_string_pin<span class="op">$</span>Interactor_B <span class="op">!=</span><span class="st"> ""</span>, ]</a>
<a class="sourceLine" id="cb5-11" data-line-number="11"></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(mmu_string_pin, <span class="dv">2</span>)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="center">Interactor_A</th>
<th align="center">Interactor_B</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">Gnai3</td>
<td align="center">Ppy</td>
</tr>
<tr class="even">
<td align="center">Gnai3</td>
<td align="center">Ccr3</td>
</tr>
</tbody>
</table>
<p>Next, we remove self interactions and any duplicated interactions, format the data frame as SIF:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># remove self interactions</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">self_intr_cond &lt;-<span class="st"> </span>mmu_string_pin<span class="op">$</span>Interactor_A <span class="op">==</span><span class="st"> </span>mmu_string_pin<span class="op">$</span>Interactor_B</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">mmu_string_pin &lt;-<span class="st"> </span>mmu_string_pin[<span class="op">!</span>self_intr_cond, ]</a>
<a class="sourceLine" id="cb6-4" data-line-number="4"></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co"># remove duplicated inteactions (including symmetric ones)</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6">mmu_string_pin &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(mmu_string_pin, <span class="dv">1</span>, sort))) <span class="co"># this will return a matrix object</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"></a>
<a class="sourceLine" id="cb6-8" data-line-number="8">mmu_string_pin &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">A =</span> mmu_string_pin[, <span class="dv">1</span>],</a>
<a class="sourceLine" id="cb6-9" data-line-number="9">                             <span class="dt">pp =</span> <span class="st">"pp"</span>,</a>
<a class="sourceLine" id="cb6-10" data-line-number="10">                             <span class="dt">B =</span> mmu_string_pin[, <span class="dv">2</span>])</a></code></pre></div>
<p>Finally we save the gene symbol PIN as a SIF file named “mmusculusPIN.sif” under the temporary directory (i.e. <code><a href="https://rdrr.io/r/base/tempfile.html">tempdir()</a></code>):</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">path2SIF &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span>(), <span class="st">"mmusculusPIN.sif"</span>)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/utils/write.table.html">write.table</a></span>(mmu_string_pin,</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">            <span class="dt">file =</span> path2SIF,</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">            <span class="dt">col.names =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">            <span class="dt">row.names =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb7-6" data-line-number="6">            <span class="dt">sep =</span> <span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</a>
<a class="sourceLine" id="cb7-7" data-line-number="7">path2SIF &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/normalizePath.html">normalizePath</a></span>(path2SIF)</a></code></pre></div>
<p>We’ll use this path to the custom sif for analysis with <code><a href="../reference/run_pathfindr.html">run_pathfindR()</a></code>.</p>
<blockquote>
<p>The STRING Mus musculus PIN created above is available in pathfindR and can be used via setting <code>pin_name_path = "mmu_STRING"</code> in <code><a href="../reference/run_pathfindr.html">run_pathfindR()</a></code>.</p>
</blockquote>
</div>
</div>
<div id="running-pathfindr-on-non-homo-sapiens-data" class="section level1">
<h1 class="hasAnchor">
<a href="#running-pathfindr-on-non-homo-sapiens-data" class="anchor"></a>Running pathfindR on non-Homo sapiens data</h1>
<div id="input-data" class="section level2">
<h2 class="hasAnchor">
<a href="#input-data" class="anchor"></a>Input Data</h2>
<p>The data used in this vignette (<code>myeloma_input</code>) is the data frame of differentially-expressed genes along for the GEO dataset <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE99393">GSE99393</a>. The RNA microarray experiment was perform to detail the global program of gene expression underlying polarization of myeloma-associated macrophages by CSF1R antibody treatment. The samples are 6 murine bone marrow derived macrophages co-cultured with myeloma cells (myeloma-associated macrophages), 3 of which were treated with CSF1R antibody (treatment group) and the rest were treated with control IgG antibody (control group). In <code>myeloma_input</code>, 45 differentially-expressed genes with |logFC| &gt;= 2 and FDR &lt;= 0.05 are presented.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(myeloma_input))</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Gene_Symbol</th>
<th align="right">FDR</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Aoah</td>
<td align="right">8.23e-05</td>
</tr>
<tr class="even">
<td align="left">AW112010</td>
<td align="right">8.23e-05</td>
</tr>
<tr class="odd">
<td align="left">F13a1</td>
<td align="right">8.23e-05</td>
</tr>
<tr class="even">
<td align="left">Pde3b</td>
<td align="right">8.23e-05</td>
</tr>
<tr class="odd">
<td align="left">P2ry14</td>
<td align="right">8.23e-05</td>
</tr>
<tr class="even">
<td align="left">Fcgrt</td>
<td align="right">8.23e-05</td>
</tr>
</tbody>
</table>
</div>
<div id="executing-run_pathfindr" class="section level2">
<h2 class="hasAnchor">
<a href="#executing-run_pathfindr" class="anchor"></a>Executing <code>run_pathfindR()</code>
</h2>
<p>After obtaining the necessary PIN and gene sets data, you can then perform pathfindR analysis by setting these arguments: - <code>convert2alias = FALSE</code>: alias conversion only works on H.sapiens genes - <code>pin_name_path = path2SIF</code>: as we’re using a non-built-in PIN, we need to provide the path to the mmu sif file - <code>gene_sets = "Custom</code>: as we’re using a non-built-in source for gene sets - <code>custom_genes = mmu_kegg_genes</code> - <code>custom_descriptions = mmu_kegg_descriptions</code></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">myeloma_output &lt;-<span class="st"> </span><span class="kw"><a href="../reference/run_pathfindr.html">run_pathfindR</a></span>(<span class="dt">input =</span> myeloma_input,</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">                                <span class="dt">convert2alias =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">                                <span class="dt">gene_sets =</span> <span class="st">"Custom"</span>,</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">                                <span class="dt">custom_genes =</span> mmu_kegg_genes,</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">                                <span class="dt">custom_descriptions =</span> mmu_kegg_descriptions,</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">                                <span class="dt">pin_name_path =</span> path2SIF)</a></code></pre></div>
<p><img src="non_hs_analysis_files/figure-html/enr_chart-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(myeloma_output)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">ID</th>
<th align="left">Term_Description</th>
<th align="right">Fold_Enrichment</th>
<th align="right">occurrence</th>
<th align="right">lowest_p</th>
<th align="right">highest_p</th>
<th align="left">Up_regulated</th>
<th align="left">Down_regulated</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">mmu04060</td>
<td align="left">Cytokine-cytokine receptor interaction</td>
<td align="right">12.238095</td>
<td align="right">10</td>
<td align="right">0.0000062</td>
<td align="right">0.0000062</td>
<td align="left">CCL8, CCL12, CXCL10, IL15, IL1B, TNFSF10, LIFR</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">mmu04668</td>
<td align="left">TNF signaling pathway</td>
<td align="right">16.895070</td>
<td align="right">10</td>
<td align="right">0.0000218</td>
<td align="right">0.0000218</td>
<td align="left">CCL12, CXCL10, IL1B, IL15</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">mmu04625</td>
<td align="left">C-type lectin receptor signaling pathway</td>
<td align="right">13.257936</td>
<td align="right">10</td>
<td align="right">0.0001561</td>
<td align="right">0.0001561</td>
<td align="left">IL1B, CLEC4N, CLEC4E</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">mmu00230</td>
<td align="left">Purine metabolism</td>
<td align="right">7.231602</td>
<td align="right">10</td>
<td align="right">0.0002864</td>
<td align="right">0.0002864</td>
<td align="left">GDA, PDE3B</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">mmu04217</td>
<td align="left">Necroptosis</td>
<td align="right">6.321665</td>
<td align="right">10</td>
<td align="right">0.0004299</td>
<td align="right">0.0004299</td>
<td align="left">IL1B, TNFSF10</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">mmu04623</td>
<td align="left">Cytosolic DNA-sensing pathway</td>
<td align="right">16.458128</td>
<td align="right">10</td>
<td align="right">0.0004674</td>
<td align="right">0.0004674</td>
<td align="left">CXCL10, IL1B</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">mmu05164</td>
<td align="left">Influenza A</td>
<td align="right">11.932143</td>
<td align="right">10</td>
<td align="right">0.0005121</td>
<td align="right">0.0005121</td>
<td align="left">IL1B, CCL12, CXCL10, TNFSF10</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">mmu05323</td>
<td align="left">Rheumatoid arthritis</td>
<td align="right">16.845378</td>
<td align="right">10</td>
<td align="right">0.0014892</td>
<td align="right">0.0014892</td>
<td align="left">IL15, IL1B, CCL12</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">mmu04657</td>
<td align="left">IL-17 signaling pathway</td>
<td align="right">16.088282</td>
<td align="right">10</td>
<td align="right">0.0017111</td>
<td align="right">0.0017111</td>
<td align="left">CXCL10, CCL12, IL1B</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">mmu04620</td>
<td align="left">Toll-like receptor signaling pathway</td>
<td align="right">9.840943</td>
<td align="right">10</td>
<td align="right">0.0022185</td>
<td align="right">0.0022185</td>
<td align="left">IL1B, CXCL10</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">mmu00760</td>
<td align="left">Nicotinate and nicotinamide metabolism</td>
<td align="right">11.641115</td>
<td align="right">10</td>
<td align="right">0.0083590</td>
<td align="right">0.0083590</td>
<td align="left">ART2B</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">mmu04630</td>
<td align="left">JAK-STAT signaling pathway</td>
<td align="right">5.929015</td>
<td align="right">10</td>
<td align="right">0.0101609</td>
<td align="right">0.0101609</td>
<td align="left">IL15, LIFR</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">mmu05134</td>
<td align="left">Legionellosis</td>
<td align="right">8.229064</td>
<td align="right">10</td>
<td align="right">0.0168361</td>
<td align="right">0.0168361</td>
<td align="left">IL1B</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">mmu04621</td>
<td align="left">NOD-like receptor signaling pathway</td>
<td align="right">11.431993</td>
<td align="right">10</td>
<td align="right">0.0196556</td>
<td align="right">0.0196556</td>
<td align="left">IL1B, CCL12, GBP2, GBP7</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">mmu05020</td>
<td align="left">Prion diseases</td>
<td align="right">14.037815</td>
<td align="right">10</td>
<td align="right">0.0284670</td>
<td align="right">0.0284670</td>
<td align="left">IL1B</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">mmu05143</td>
<td align="left">African trypanosomiasis</td>
<td align="right">13.636735</td>
<td align="right">10</td>
<td align="right">0.0301863</td>
<td align="right">0.0301863</td>
<td align="left">IL1B</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">mmu04012</td>
<td align="left">ErbB signaling pathway</td>
<td align="right">5.820557</td>
<td align="right">10</td>
<td align="right">0.0337844</td>
<td align="right">0.0337844</td>
<td align="left">NRG1</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">mmu04672</td>
<td align="left">Intestinal immune network for IgA production</td>
<td align="right">11.641115</td>
<td align="right">10</td>
<td align="right">0.0415514</td>
<td align="right">0.0415514</td>
<td align="left">IL15</td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p>Because we used a very strict cut-off (logFC &gt;= 2 + FDR &lt;= 0.05), there were only 18 enriched KEGG pathways. However, the pathways identified here significantly related to the pathways identified in the original publication by Wang et al.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>.</p>
</div>
<div id="built-in-mus-musculus-data" class="section level2">
<h2 class="hasAnchor">
<a href="#built-in-mus-musculus-data" class="anchor"></a>Built-in Mus musculus Data</h2>
<p>For Mus musculus (only), we have provided the necessary PIN (<code>mmu_STRING</code>) and gene set data (<code>mmu_KEGG</code>) so you can also run:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">myeloma_output &lt;-<span class="st"> </span><span class="kw"><a href="../reference/run_pathfindr.html">run_pathfindR</a></span>(<span class="dt">input =</span> myeloma_input,</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">                                <span class="dt">convert2alias =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">                                <span class="dt">gene_sets =</span> <span class="st">"mmu_KEGG"</span>,</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">                                <span class="dt">pin_name_path =</span> <span class="st">"mmu_STRING"</span>)</a></code></pre></div>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>Wang Q, Lu Y, Li R, et al. Therapeutic effects of CSF1R-blocking antibodies in multiple myeloma. Leukemia. 2018;32(1):176-183.<a href="#fnref1" class="footnote-back">↩</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#preparation-of-necessary-data">Preparation of Necessary Data</a><ul class="nav nav-pills nav-stacked">
<li><a href="#obtain-organism-specific-gene-sets">Obtain Organism-specific Gene Sets</a></li>
      <li><a href="#obtain-organism-specific-protein-protein-interaction-network">Obtain Organism-specific Protein-protein Interaction Network</a></li>
      </ul>
</li>
      <li>
<a href="#running-pathfindr-on-non-homo-sapiens-data">Running pathfindR on non-Homo sapiens data</a><ul class="nav nav-pills nav-stacked">
<li><a href="#input-data">Input Data</a></li>
      <li><a href="#executing-run_pathfindr">Executing <code>run_pathfindR()</code></a></li>
      <li><a href="#built-in-mus-musculus-data">Built-in Mus musculus Data</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Ege Ulgen, Ozan Ozisik.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '7f13d388d59fea08d4add29291ea2896',
    indexName: 'pathfindr',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
