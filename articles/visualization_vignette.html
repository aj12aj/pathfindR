<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Visualization of pathfindR Enrichment Results â€¢ pathfindR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Visualization of pathfindR Enrichment Results">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pathfindR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.5.0.9004</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/intro_vignette.html">Introduction to pathfindR</a>
    </li>
    <li>
      <a href="../articles/manual_execution.html">Step-by-Step Execution of the pathfindR Enrichment Workflow</a>
    </li>
    <li>
      <a href="../articles/non_hs_analysis.html">pathfindR Analysis for non-Homo-sapiens organisms</a>
    </li>
    <li>
      <a href="../articles/obtain_data.html">Obtaining PIN and Gene Sets Data</a>
    </li>
    <li>
      <a href="../articles/visualization_vignette.html">Visualization of pathfindR Enrichment Results</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/egeulgen/pathfindR">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Visualization of pathfindR Enrichment Results</h1>
            
            <h4 class="date">2020-02-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/egeulgen/pathfindR/blob/master/vignettes/visualization_vignette.Rmd"><code>vignettes/visualization_vignette.Rmd</code></a></small>
      <div class="hidden name"><code>visualization_vignette.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(pathfindR))</a></code></pre></div>
<p><code>pathfindR</code> offers various functionalities to visualize the enrichment results. In this vignette, I try to demonstrate these functionalities.</p>
<div id="enrichment_chart-bubble-chart-of-enrichment-results" class="section level2">
<h2 class="hasAnchor">
<a href="#enrichment_chart-bubble-chart-of-enrichment-results" class="anchor"></a><code>enrichment_chart()</code>: Bubble Chart of Enrichment Results</h2>
<p><code>enrichment_chart</code> generates a bubble chart. The x-axis corresponds to fold enrichment values while the y-axis indicates the enriched terms. Size of the bubble indicates the number of significant genes in the given enriched term. Color indicates the -log10(lowest-p) value. The closer the color is to red, the more significant the enrichment is.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="../reference/enrichment_chart.html">enrichment_chart</a></span>(RA_output)</a></code></pre></div>
<p><img src="visualization_vignette_files/figure-html/enr_chart-1.png" width="768" style="display: block; margin: auto;"></p>
<p>By default, the bubble chart is generated for the top 10 terms. This can be controlled by the <code>top_terms</code> argument:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">## change top_terms</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw"><a href="../reference/enrichment_chart.html">enrichment_chart</a></span>(RA_output, <span class="dt">top_terms =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="visualization_vignette_files/figure-html/enr_chart2-1.png" width="768" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"></a>
<a class="sourceLine" id="cb4-2" data-line-number="2">## set null for displaying all terms</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="kw"><a href="../reference/enrichment_chart.html">enrichment_chart</a></span>(RA_output, <span class="dt">top_terms =</span> <span class="ot">NULL</span>)</a></code></pre></div>
<p><img src="visualization_vignette_files/figure-html/enr_chart2-2.png" width="768" style="display: block; margin: auto;"></p>
<p>If the enrichment results were clustered, setting <code>plot_by_cluster == TRUE</code> will result in the enriched terms to be grouped by clusters:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="../reference/enrichment_chart.html">enrichment_chart</a></span>(RA_clustered, <span class="dt">plot_by_cluster =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="visualization_vignette_files/figure-html/enr_chart3-1.png" width="768" style="display: block; margin: auto;"></p>
<p>See <code><a href="../reference/enrichment_chart.html">?enrichment_chart</a></code> for more details.</p>
</div>
<div id="term_gene_heatmap-terms-by-genes-heatmap" class="section level2">
<h2 class="hasAnchor">
<a href="#term_gene_heatmap-terms-by-genes-heatmap" class="anchor"></a><code>term_gene_heatmap()</code>: Terms by Genes Heatmap</h2>
<p><code><a href="../reference/term_gene_heatmap.html">term_gene_heatmap()</a></code> is used to create a heatmap where rows are enriched terms and columns are involved input genes. This heatmap allows visual identification of the input genes involved in the enriched terms, as well as the common or distinct genes between different terms.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="../reference/term_gene_heatmap.html">term_gene_heatmap</a></span>(RA_output)</a></code></pre></div>
<p><img src="visualization_vignette_files/figure-html/hmap-1.png" width="768" style="display: block; margin: auto;"></p>
<p>By default, the heatmap is generated for the top 10 terms. This can be controlled by the <code>num_terms</code> argument:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="../reference/term_gene_heatmap.html">term_gene_heatmap</a></span>(RA_output, <span class="dt">num_terms =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="visualization_vignette_files/figure-html/hmap2-1.png" width="768" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">## set null for displaying all terms</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="kw"><a href="../reference/term_gene_heatmap.html">term_gene_heatmap</a></span>(RA_output, <span class="dt">num_terms =</span> <span class="ot">NULL</span>)</a></code></pre></div>
<p><img src="visualization_vignette_files/figure-html/hmap2-2.png" width="768" style="display: block; margin: auto;"></p>
<p>By default, the term ids are used. For using full descriptions, set <code>use_description = TRUE</code></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="../reference/term_gene_heatmap.html">term_gene_heatmap</a></span>(RA_output, <span class="dt">use_description =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="visualization_vignette_files/figure-html/hmap3-1.png" width="768" style="display: block; margin: auto;"></p>
<p>If the input data frame (same as in <code><a href="../reference/run_pathfindr.html">run_pathfindR()</a></code>) is supplied, the tile colors indicate the change values:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="../reference/term_gene_heatmap.html">term_gene_heatmap</a></span>(RA_output, RA_input, <span class="dt">use_description =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co">#&gt; Number of genes provided in input: 572</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co">#&gt; Number of genes in input after p-value filtering: 572</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co">#&gt; Could not find any interactions for 11 (1.92%) genes in the PIN</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">#&gt; Final number of genes in input: 561</span></a></code></pre></div>
<p><img src="visualization_vignette_files/figure-html/hmap4-1.png" width="768" style="display: block; margin: auto;"></p>
<p>See <code><a href="../reference/term_gene_heatmap.html">?term_gene_heatmap</a></code> for more details.</p>
</div>
<div id="term_gene_graph-term-gene-graph" class="section level2">
<h2 class="hasAnchor">
<a href="#term_gene_graph-term-gene-graph" class="anchor"></a><code>term_gene_graph()</code>: Term-Gene Graph</h2>
<p>The function <code><a href="../reference/term_gene_graph.html">term_gene_graph()</a></code> (adapted from the Gene-Concept network visualization by the R package <code>enrichplot</code>) can be utilized to visualize which significant genes are involved in the enriched terms. The function creates the term-gene graph, displaying the connections between genes and biological terms (enriched pathways or gene sets). This allows for the investigation of multiple terms to which significant genes are related. The graph also enables determination of the degree of overlap between the enriched terms by identifying shared and/or distinct significant genes. By default, the function visualizes the term-gene graph for the top 10 enriched terms:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw"><a href="../reference/term_gene_graph.html">term_gene_graph</a></span>(RA_output)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="co">#&gt; Using `stress` as default layout</span></a></code></pre></div>
<p><img src="visualization_vignette_files/figure-html/term_gene1-1.png" width="768" style="display: block; margin: auto;"></p>
<p>To plot all of the enriched terms in the enrichment results, set <code>num_terms = NULL</code> (not advised due to cluttered visualization):</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw"><a href="../reference/term_gene_graph.html">term_gene_graph</a></span>(RA_output, <span class="dt">num_terms =</span> <span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="co">#&gt; Using `stress` as default layout</span></a></code></pre></div>
<p><img src="visualization_vignette_files/figure-html/term_gene2-1.png" width="768" style="display: block; margin: auto;"></p>
<p>To plot using full term names (instead of IDs which is the default), set <code>use_description = TRUE</code>:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw"><a href="../reference/term_gene_graph.html">term_gene_graph</a></span>(RA_output, <span class="dt">num_terms =</span> <span class="dv">3</span>, <span class="dt">use_description =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="co">#&gt; Using `stress` as default layout</span></a></code></pre></div>
<p><img src="visualization_vignette_files/figure-html/term_gene3-1.png" width="768" style="display: block; margin: auto;"></p>
<p>By default the node sizes are plotted proportional to the number of genes a term contains (<code>num_genes</code>). To adjust node sizes using the <span class="math inline">\(-log_{10}\)</span>(lowest p values), set <code>node_size = "p_val"</code>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw"><a href="../reference/term_gene_graph.html">term_gene_graph</a></span>(RA_output, <span class="dt">num_terms =</span> <span class="dv">3</span>, <span class="dt">node_size =</span> <span class="st">"p_val"</span>)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="co">#&gt; Using `stress` as default layout</span></a></code></pre></div>
<p><img src="visualization_vignette_files/figure-html/term_gene4-1.png" width="768" style="display: block; margin: auto;"></p>
<p>See <code><a href="../reference/term_gene_graph.html">?term_gene_graph</a></code> for more details.</p>
</div>
<div id="upset_plot-upset-plot-of-enriched-terms" class="section level2">
<h2 class="hasAnchor">
<a href="#upset_plot-upset-plot-of-enriched-terms" class="anchor"></a><code>UpSet_plot()</code>: UpSet Plot of Enriched Terms</h2>
<p>UpSet plots are plots of the intersections of sets as a matrix. <code><a href="../reference/UpSet_plot.html">UpSet_plot()</a></code> creates a ggplot object of an UpSet plot where the x-axis is the UpSet plot of intersections of enriched terms and the main plot is a bar plot of the number of genes in the corresponding intersections (default).</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw"><a href="../reference/UpSet_plot.html">UpSet_plot</a></span>(RA_output)</a></code></pre></div>
<p><img src="visualization_vignette_files/figure-html/upset1-1.png" width="768" style="display: block; margin: auto;"></p>
<p>Again, you may change the number of top terms plotted via <code>num_terms</code> (default = 10):</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw"><a href="../reference/UpSet_plot.html">UpSet_plot</a></span>(RA_output, <span class="dt">num_terms =</span> <span class="dv">5</span>)</a></code></pre></div>
<p><img src="visualization_vignette_files/figure-html/upset2-1.png" width="768" style="display: block; margin: auto;"></p>
<p>Again, to plot using full term names (instead of IDs which is the default), set <code>use_description = TRUE</code>:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw"><a href="../reference/UpSet_plot.html">UpSet_plot</a></span>(RA_output, <span class="dt">use_description =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="visualization_vignette_files/figure-html/upset3-1.png" width="768" style="display: block; margin: auto;"></p>
<p>If <code>genes_df</code> is provided, then the main plot displays the boxplots of change values of the genes within the corresponding intersections:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw"><a href="../reference/UpSet_plot.html">UpSet_plot</a></span>(RA_output, RA_input, <span class="dt">use_description =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="co">#&gt; Number of genes provided in input: 572</span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="co">#&gt; Number of genes in input after p-value filtering: 572</span></a>
<a class="sourceLine" id="cb18-4" data-line-number="4"><span class="co">#&gt; Could not find any interactions for 11 (1.92%) genes in the PIN</span></a>
<a class="sourceLine" id="cb18-5" data-line-number="5"><span class="co">#&gt; Final number of genes in input: 561</span></a></code></pre></div>
<p><img src="visualization_vignette_files/figure-html/upset4-1.png" width="768" style="display: block; margin: auto;"></p>
<p>See <code><a href="../reference/UpSet_plot.html">?UpSet_plot</a></code> for more details.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#enrichment_chart-bubble-chart-of-enrichment-results"><code>enrichment_chart()</code>: Bubble Chart of Enrichment Results</a></li>
      <li><a href="#term_gene_heatmap-terms-by-genes-heatmap"><code>term_gene_heatmap()</code>: Terms by Genes Heatmap</a></li>
      <li><a href="#term_gene_graph-term-gene-graph"><code>term_gene_graph()</code>: Term-Gene Graph</a></li>
      <li><a href="#upset_plot-upset-plot-of-enriched-terms"><code>UpSet_plot()</code>: UpSet Plot of Enriched Terms</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Ege Ulgen, Ozan Ozisik.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '7f13d388d59fea08d4add29291ea2896',
    indexName: 'pathfindr',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
